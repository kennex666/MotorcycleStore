package dao;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;

import connectDB.ConnectDB;
import entity.ChiTietSuaChua;
import entity.Kho;
import entity.LinhKien;
import entity.NhaCungCap;
import entity.Xe;
import interfaces.ILinhKien;

public class LinhKien_DAO implements ILinhKien {
	Connection con = ConnectDB.getConnection();

	@Override
	public ArrayList<LinhKien> getAllLinhKien() throws Exception {
		// TODO Auto-generated method stub
		ArrayList<LinhKien> list = new ArrayList<>();
		String query = "Select * from LinhKien";
		try {
			Statement stm = con.createStatement();
			ResultSet results = stm.executeQuery(query);
			while (results.next()) {
				String maLK = results.getString("MaLinhKien");
				String maNCC = results.getString("MaNCC");
				int maKho = results.getInt("MaKho");
				int maCTSC = results.getInt("MaCTSuaChua");
				String tenLK = results.getString("TenLinhKien");
				String imgPath = results.getString("ImgPath");
				double gia = results.getDouble("GiaBan");

				int soLuongBan = results.getInt("SoLuongBan");
				int soLuongKho = results.getInt("SoLuongKho");
				NhaCungCap nhaCungCap = new NhaCungCap(maNCC);
				ChiTietSuaChua ctsc = new ChiTietSuaChua(maCTSC);
				
				LinhKien lk = new LinhKien(maLK, tenLK, imgPath, nhaCungCap, ctsc, gia, soLuongKho, soLuongBan);
				
				list.add(lk);
			}
		} 
		catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return list;
	}
	
}
